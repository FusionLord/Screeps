var _ = require('lodash');

module.exports = {
    run() {
        for (var i in Game.spawns) {
            var spawn = Game.spawns[i];
            if (spawn.energy > 200) {
                var count = _.filter(Game.creeps, function(creep){ return creep.name.startsWith('Harvester') && creep.ticksToLive > 12; }).length
                if (count < 5) {
                    spawn.createCreep([WORK, CARRY, MOVE], 'Harvester');
                }
                count = _.filter(Game.creeps, function(creep){ return creep.name.startsWith('Builder') && creep.ticksToLive > 12; }).length
                if (count < 3) {
                    spawn.createCreep([WORK, CARRY, MOVE], 'Builder');
                }
                count = _.filter(Game.creeps, function(creep){ return creep.name.startsWith('Upgrader') && creep.ticksToLive > 12; }).length
                if (count < 2) {
                    spawn.createCreep([WORK, CARRY, MOVE], 'Upgrader');
                }
            }
        }
    }
};